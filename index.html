<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J.A.S.I AI Agent</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        :root {
            --primary-glow-color: #00d9ff;
            --secondary-glow-color: #00aaff;
            --background-color: #0c0c1a;
            --text-color: #e0e0e0;
            --orb-color: #1a1a3a;
        }
        body {
            margin: 0; font-family: 'Roboto', sans-serif; background-color: var(--background-color); color: var(--text-color);
            display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh; overflow: hidden;
            background-image: radial-gradient(circle, rgba(255, 255, 255, 0.05) 1px, transparent 1px); background-size: 20px 20px;
        }
        .ai-container {
            width: 100%; max-width: 800px; height: 100%; display: flex;
            flex-direction: column; justify-content: space-between; align-items: center;
            padding: 20px; box-sizing: border-box;
        }
        #conversationLog {
            width: 100%; flex-grow: 1; background: rgba(0, 0, 0, 0.2); border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 15px; padding: 20px; box-sizing: border-box; overflow-y: auto;
            font-size: 1.1em; line-height: 1.6; box-shadow: 0 0 15px rgba(0, 217, 255, 0.1); margin-bottom: 15px;
        }
        .ai-core { display: flex; justify-content: center; align-items: center; width: 100%; padding-top: 20px; }
        #orb {
            width: 120px; height: 120px; background-color: var(--orb-color); border-radius: 50%; cursor: pointer; position: relative;
            border: 3px solid var(--secondary-glow-color); box-shadow: 0 0 20px var(--secondary-glow-color), inset 0 0 20px rgba(0, 217, 255, 0.5);
            transition: transform 0.3s ease, box-shadow 0.3s ease; animation: pulse 4s infinite ease-in-out;
        }
        #orb:hover { transform: scale(1.05); box-shadow: 0 0 35px var(--primary-glow-color), inset 0 0 30px rgba(0, 217, 255, 0.7); }
        .title {
            font-family: 'Orbitron', sans-serif; font-size: 2em; text-align: center; padding: 10px 0;
            color: var(--primary-glow-color); text-shadow: 0 0 10px var(--primary-glow-color);
        }
        .controls-container { width: 100%; display: flex; justify-content: center; margin-top: 15px; gap: 15px; } /* Added gap */
        .gradient-button {
            font-family: 'Orbitron', sans-serif; color: var(--text-color); border: 1px solid var(--primary-glow-color); border-radius: 8px;
            padding: 10px 20px; font-size: 1em; cursor: pointer;
            background: linear-gradient(90deg, var(--secondary-glow-color), var(--primary-glow-color), var(--secondary-glow-color));
            background-size: 200% 100%; background-position: 100% 0;
            transition: background-position 0.5s ease, box-shadow 0.3s; box-shadow: 0 0 8px rgba(0, 217, 255, 0.3);
        }
        .gradient-button:hover { background-position: 0 0; box-shadow: 0 0 15px rgba(0, 217, 255, 0.7); }
        .input-container {
            width: 100%; display: flex; background: rgba(0, 0, 0, 0.2); border: 1px solid rgba(0, 217, 255, 0.2);
            border-radius: 15px; padding: 5px; box-shadow: 0 0 15px rgba(0, 217, 255, 0.1);
        }
        #textInput {
            flex-grow: 1; background: transparent; border: none; color: var(--text-color);
            font-size: 1.1em; padding: 10px; outline: none; resize: none; font-family: 'Roboto', sans-serif;
        }
        #textSendButton {
            background: transparent; border: none; color: var(--primary-glow-color);
            cursor: pointer; padding: 10px; font-size: 1.5em; transition: color 0.3s;
        }
        #textSendButton:hover { color: #fff; }

        /* --- GALLERY & MODAL STYLING --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(12, 12, 26, 0.9);
            display: flex; justify-content: center; align-items: center; z-index: 1000; animation: fadeIn 0.3s ease;
        }
        .modal-content {
            background-color: var(--orb-color); padding: 25px; border: 1px solid var(--primary-glow-color);
            border-radius: 15px; box-shadow: 0 0 30px var(--primary-glow-color); width: 90%; max-width: 1000px;
            max-height: 90vh; position: relative; animation: scaleUp 0.3s ease; display: flex; flex-direction: column;
        }
        .modal-close-button {
            position: absolute; top: 15px; right: 25px; font-size: 35px;
            font-weight: bold; color: var(--primary-glow-color); cursor: pointer; transition: color 0.3s;
        }
        .modal-close-button:hover { color: #fff; }
        .gallery-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px; margin-top: 20px; overflow-y: auto;
        }
        .gallery-grid img {
            width: 100%; height: auto; border-radius: 10px; border: 2px solid var(--secondary-glow-color);
            cursor: pointer; transition: transform 0.3s, border-color 0.3s;
        }
        .gallery-grid img:hover { transform: scale(1.05); border-color: var(--primary-glow-color); }
        .video-gallery-layout { display: flex; gap: 20px; margin-top: 20px; height: 500px; }
        .video-player-wrapper { flex: 3; background-color: #000; }
        #mainVideoPlayer { width: 100%; height: 100%; }
        .video-playlist { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .playlist-item {
            display: flex; align-items: center; gap: 10px; cursor: pointer; padding: 8px;
            border-radius: 8px; border: 1px solid transparent; transition: background-color 0.3s, border-color 0.3s;
        }
        .playlist-item:hover { background-color: rgba(0, 217, 255, 0.1); }
        .playlist-item.active { border-color: var(--primary-glow-color); background-color: rgba(0, 217, 255, 0.2); }
        .playlist-item img { width: 80px; height: 45px; object-fit: cover; border-radius: 5px; }

        .lightbox-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); display: flex;
            justify-content: center; align-items: center;
            z-index: 2000; cursor: pointer; animation: fadeIn 0.2s ease;
        }
        .lightbox-overlay img {
            max-width: 90vw; max-height: 90vh; border: 2px solid var(--primary-glow-color);
            border-radius: 10px; box-shadow: 0 0 40px var(--primary-glow-color);
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes scaleUp { from { transform: scale(0.8); } to { transform: scale(1); } }
        #orb.listening { animation: spin 2s linear infinite; }
        #orb.speaking { animation: glow-speak 1.5s infinite ease-in-out; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes glow-speak { 0%, 100% { border-color: var(--secondary-glow-color); } 50% { border-color: var(--primary-glow-color); transform: scale(1.05); } }
    </style>
</head>
<body>
    <div class="ai-container">
        <h1 class="title">J.A.S.I</h1>
        <div id="conversationLog">
            <p><strong>J.A.S.I:</strong> At your service, Mr. Jain. English mode is active.</p>
        </div>
        
        <div class="input-container">
            <textarea id="textInput" placeholder="Type your command..." rows="1"></textarea>
            <button id="textSendButton" title="Send">▶</button>
        </div>
        <div class="controls-container">
            <button id="languageToggle" class="gradient-button">हिन्दी में बदलें</button>
            <!-- NEW: Stop button added -->
            <button id="stopButton" class="gradient-button">Stop</button>
        </div>

        <div class="ai-core">
            <div id="orb" title="Activate Voice Command"></div>
        </div>
    </div>

    <script>
        // --- Element References & State ---
        const orb = document.getElementById('orb');
        const conversationLog = document.getElementById('conversationLog');
        const languageToggle = document.getElementById('languageToggle');
        const textInput = document.getElementById('textInput');
        const textSendButton = document.getElementById('textSendButton');
        const stopButton = document.getElementById('stopButton'); // NEW: Stop button reference
        let currentLanguage = 'en-US';

        // --- Sound & Speech Setup ---
        const activateSound = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.005, decay: 0.1, sustain: 0.3, release: 0.1 } }).toDestination();
        const deactivateSound = new Tone.Synth({ oscillator: { type: 'triangle' }, envelope: { attack: 0.005, decay: 0.2, sustain: 0.2, release: 0.2 } }).toDestination();
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) { alert("Sorry, your browser does not support the Web Speech API. Please use Google Chrome."); }
        const recognition = new SpeechRecognition();
        recognition.continuous = false;
        recognition.lang = currentLanguage;
        recognition.interimResults = false;
        recognition.maxAlternatives = 1;

        // --- Event Listeners ---
        orb.addEventListener('click', async () => {
            if (orb.classList.contains('listening') || orb.classList.contains('speaking')) return;
            try { await Tone.start(); activateSound.triggerAttackRelease("C5", "8n"); } catch (e) {}
            orb.classList.add('listening');
            recognition.start();
            logToConversation("J.A.S.I", currentLanguage === 'hi-IN' ? "सुन रहा हूँ..." : "Listening...");
        });

        languageToggle.addEventListener('click', () => {
            currentLanguage = (currentLanguage === 'en-US') ? 'hi-IN' : 'en-US';
            languageToggle.textContent = (currentLanguage === 'en-US') ? 'हिन्दी में बदलें' : 'Switch to English';
            recognition.lang = currentLanguage;
            logToConversation("J.A.S.I", `Language set to ${currentLanguage === 'hi-IN' ? 'Hindi' : 'English'}.`);
        });

        textSendButton.addEventListener('click', handleTextInput);
        textInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); handleTextInput(); }
        });
        
        // NEW: Event listener for the stop button
        stopButton.addEventListener('click', () => {
            window.speechSynthesis.cancel(); // This stops the speech
            orb.classList.remove('speaking'); // Also remove the speaking animation
        });
        
        recognition.onresult = (event) => processUserInput(event.results[0][0].transcript);
        recognition.onend = () => orb.classList.remove('listening');
        recognition.onerror = (event) => logToConversation("J.A.S.I", `Recognition Error: ${event.error}`);

        // --- Core Logic Functions ---
        function handleTextInput() {
            const text = textInput.value.trim();
            if (text) {
                processUserInput(text);
                textInput.value = '';
                textInput.style.height = 'auto';
            }
        }

        function processUserInput(text) {
            logToConversation("You", text);
            if (!handleAppCommands(text)) { getAIResponse(text); }
        }
        
         function handleAppCommands(transcript) {
            const command = transcript.toLowerCase();
            const useHindi = (currentLanguage === 'hi-IN');
            const apps = {
                'youtube': 'https://www.youtube.com',
                'whatsapp': 'https://web.whatsapp.com',
                'google': 'https://www.google.com',
                'github': 'https://www.github.com',
                'instagram': 'https://www.instagram.com'
            };

            for (const appName in apps) {
                if (command.includes(`open ${appName}`) || command.includes(`${appName} खोलो`)) {
                    const url = apps[appName];
                    const response = `Of course, Mr. Jain. Opening ${appName}.`;
                    const responseHi = `ज़रूर, Mr. Jain. आपके लिए ${appName} खोल रहा हूँ।`;
                    const finalResponse = isHindi(command) ? responseHi : response;
                    logToConversation("J.A.S.I", finalResponse);
                    speak(finalResponse);
                    window.open(url, '_blank');
                    return true;
                }
            }

            if (command.includes("show a princess") || command.includes("show me princess") || command.includes("aditi ki photo") || command.includes("राजकुमारी दिखाओ")||  command.includes("beautiful girl in  whole world") ) {
                const response = "Of course, sir. Displaying the images of the princess for you.";
                const responseHi = "ज़रूर, सर। आपके लिए राजकुमारी की तस्वीरें दिखा रहा हूँ।";
                respond(useHindi ? responseHi : response);
                const princessImages = ['images/aditi16.jpg','images/aditi17.jpg','images/aditi18.jpg'  ,'images/aditi19.jpg' ,'images/aditi20.jpg'  ,'images/aditi15.jpg', 'images/aditi2.jpg', 'images/aditi3.jpg', 'images/aditi4.jpg', 'images/aditi5.jpg', 'images/aditi6.jpg', 'images/aditi7.jpg','images/aditi8.jpg','images/aditi9.jpg','images/aditi10.jpg','images/aditi11.jpg', 'images/aditi12.jpg','images/aditi14.jpg','images/aditi1.jpg' ];
                showImageGallery(princessImages);
                return true;
            }

            if (command.includes("video") || command.includes("वीडियो")) {
                const response = "Opening the video library, sir.";
                const responseHi = "वीडियो लाइब्रेरी खोल रहा हूँ, सर।";
                respond(useHindi ? responseHi : response);
                const videoLibrary = [
                    { title: "aditi-natural", videoSrc: "videos/aditi1.mp4", thumbSrc: "videos/thumb1.jpg" },
                    { title: "aditi in shadi", videoSrc: "videos/aditi2.mp4", thumbSrc: "videos/thumb2.jpg" },
                    { title: "aditi-cat", videoSrc: "videos/aditi3.mp4", thumbSrc: "videos/thumb3.jpg" },
                    { title: "aditi-flower", videoSrc: "videos/aditi4.mp4", thumbSrc: "videos/thumb4.jpg" },
                    { title: "aditi-flower2", videoSrc: "videos/aditi5.mp4", thumbSrc: "videos/thumb5.jpg" },
                    { title: "aditi-dancer", videoSrc: "videos/aditi6.mp4", thumbSrc: "videos/thumb6.jpg" },
                    { title: "aditi-happy", videoSrc: "videos/aditi7.mp4", thumbSrc: "videos/thumb7.jpg" },
                    { title: "aditi-nautanki", videoSrc: "videos/aditi8.mp4", thumbSrc: "videos/thumb8.jpg" },
                    { title: "aditi in jhula", videoSrc: "videos/aditi9.mp4", thumbSrc: "videos/thumb9.jpg" },
                    { title: "aditi in funny mood", videoSrc: "videos/aditi10.mp4", thumbSrc: "videos/thumb10.jpg" }
                    
                ];
                showVideoGallery(videoLibrary);
                return true;
            }
              if (command.includes("time") || command.includes("समय")) {
                const timeString = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
                const response = `Sir, the current time is ${timeString}.`;
                const responseHi = `सर, अभी ${timeString} हैं।`;
                respond(useHindi ? responseHi : response);
                return true;
            }
            if (command.includes("date") || command.includes("तारीख")) {
                const dateString = new Date().toLocaleDateString('en-GB', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                const response = `Today's date is ${dateString}.`;
                const responseHi = `आज ${dateString} है।`;
                respond(useHindi ? responseHi : response);
                return true;
            }

            // --- PRINCESS COMMANDS ---
           
            if (command.includes("about aditi") || command.includes("about the princess") || command.includes("अदिति के बारे में") || command.includes("राजकुमारी के बारे में")) {
                const descriptionEn = `Princess Aditi is the very picture of royal grace and charm. Her beauty is truly captivating, but it is the genuine warmth in her smile and the kindness in her eyes that leave a lasting impression. Her voice is as gentle and soothing as a calm melody, and her friendly nature makes everyone around her feel instantly at ease and valued. She possesses a rare spirit, full of goodness and light, making her a true princess in every sense of the word.
                Her laughter is infectious, and her presence brings joy to all who have the privilege of knowing her. She is not just a princess by title, but a beacon of hope and positivity, inspiring those around her to be their best selves. Whether she is engaging in royal duties or simply enjoying a quiet moment, Princess Aditi embodies the essence of true nobility and grace.  My calculations indicate a special event is imminent.  August 4th, please allow me to extend the warmest wishes to Princess Aditi on her birthday. May her day be filled with as much joy and happiness as she brings to others. A very happy birthday to her.`;
                const descriptionHi = `ज़रूर, Mr. Jain. राजकुमारी अदिति का सौंदर्य तेजस्वी और मनोरम है। उनका लावण्य और तेजोमय मुखमंडल किसी को भी मंत्रमुग्ध कर सकता है। उनका स्वभाव अत्यंत सरल और स्नेहपूर्ण है, और उनकी विनम्रता उनके व्यक्तित्व में चार चाँद लगा देती है।

उनकी वाणी में एक अलौकिक कोमलता है, जो हर शब्द को कर्णप्रिय बना देती है। वे सकारात्मकता और सद्गुणों की प्रतिमूर्ति हैं, एक ऐसी राजकुमारी जिनका हृदय उनके रूप से भी अधिक सुंदर है।

उनके जन्मदिन के लिए एक और संदेश
 4 अगस्त को, उनके जन्मदिवस के इस पावन अवसर पर, मैं उनके लिए अनंत खुशियों और सफलता की कामना करता हूँ। यह दिन उनके जीवन में नई ऊर्जा और उल्लास लेकर आए। उन्हें जन्मदिन की ढेरों बधाइयाँ।`;
                respond(useHindi ? descriptionHi : descriptionEn);
                return true;
            }

            return false;
        }

           async function getAIResponse(userPrompt) {
            logToConversation("J.A.S.I", "Thinking...");
            const apiKey = "AIzaSyBUP20ab6Rfa2zSiYu1BPQYJFZ1WWN7oW0"; 
            // ✅ CORRECTED API URL
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const personalityPrompt = `You are J.A.S.I., a helpful AI. Your user is Sambhav Jain. Your primary response language is set to ${currentLanguage}. Respond in this language unless the user's prompt forces another. Keep responses concise. User request: "${userPrompt}"`;
            const payload = { contents: [{ parts: [{ text: personalityPrompt }] }] };

            try {
                const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                if (!response.ok) {
                    // Log more detailed error information
                    const errorBody = await response.text();
                    console.error(`API request failed: ${response.status}`, errorBody);
                    throw new Error(`API request failed: ${response.status}`);
                }
                const data = await response.json();

                // Add a check to ensure the response has the expected structure
                if (data.candidates && data.candidates.length > 0 && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts.length > 0) {
                    respond(data.candidates[0].content.parts[0].text);
                } else {
                    console.error("Invalid response structure from API:", data);
                    respond("My apologies, sir. I received an unusual response from my systems.");
                }

            } catch (error) {
                console.error("Error calling Gemini API:", error);
                respond("There appears to be a connection issue, sir.");
            }
        }
        // --- Helper & Utility Functions ---
        function respond(text) {
            logToConversation("J.A.S.I", text);
            speak(text);
        }

        function showLightBox(imageSrc) {
            const lightbox = document.createElement('div');
            lightbox.className = 'lightbox-overlay';
            lightbox.innerHTML = `<img src="${imageSrc}" alt="Enlarged image">`;
            lightbox.onclick = () => document.body.removeChild(lightbox);
            document.body.appendChild(lightbox);
        }

        function showImageGallery(imageUrls) {
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal-overlay';
            modalOverlay.innerHTML = `
                <div class="modal-content">
                    <span class="modal-close-button">&times;</span>
                    <h2 class="title">Image Gallery</h2>
                    <div class="gallery-grid"></div>
                </div>`;
            
            const grid = modalOverlay.querySelector('.gallery-grid');
            imageUrls.forEach(url => {
                const img = document.createElement('img');
                img.src = url;
                img.alt = "Gallery Image";
                img.addEventListener('click', () => showLightBox(url));
                grid.appendChild(img);
            });

            document.body.appendChild(modalOverlay);
            modalOverlay.querySelector('.modal-close-button').onclick = () => document.body.removeChild(modalOverlay);
        }

        function showVideoGallery(videos) {
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal-overlay';
            modalOverlay.innerHTML = `
                <div class="modal-content">
                    <span class="modal-close-button">&times;</span>
                    <h2 class="title">Video Library</h2>
                    <div class="video-gallery-layout">
                        <div class="video-player-wrapper"><video id="mainVideoPlayer" src="${videos[0].videoSrc}" controls autoplay></video></div>
                        <div class="video-playlist"></div>
                    </div>
                </div>`;
            
            const playlistContainer = modalOverlay.querySelector('.video-playlist');
            const mainPlayer = modalOverlay.querySelector('#mainVideoPlayer');

            videos.forEach((video, index) => {
                const item = document.createElement('div');
                item.className = 'playlist-item';
                if (index === 0) item.classList.add('active');
                item.innerHTML = `<img src="${video.thumbSrc}" alt="${video.title}"><span>${video.title}</span>`;
                item.onclick = () => {
                    mainPlayer.src = video.videoSrc;
                    mainPlayer.play();
                    modalOverlay.querySelector('.playlist-item.active').classList.remove('active');
                    item.classList.add('active');
                };
                playlistContainer.appendChild(item);
            });
            
            document.body.appendChild(modalOverlay);
            modalOverlay.querySelector('.modal-close-button').onclick = () => document.body.removeChild(modalOverlay);
        }

        function isHindi(text) { return /[\u0900-\u097F]/.test(text); }

        function speak(text) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            const voices = window.speechSynthesis.getVoices();
            let selectedVoice = isHindi(text)
                ? voices.find(voice => voice.lang === 'hi-IN')
                : voices.find(voice => voice.lang === 'en-US' || voice.lang === 'en-GB');
            utterance.voice = selectedVoice;
            utterance.onstart = () => orb.classList.add('speaking');
            utterance.onend = () => { orb.classList.remove('speaking'); deactivateSound.triggerAttackRelease("G4", "8n"); };
            window.speechSynthesis.speak(utterance);
        }
        
        function logToConversation(speaker, message) {
            const p = document.createElement('p');
            p.innerHTML = `<strong>${speaker}:</strong> ${message.replace(/\n/g, '<br>')}`;
            conversationLog.appendChild(p);
            conversationLog.scrollTop = conversationLog.scrollHeight;
        }

        textInput.addEventListener('input', () => {
            textInput.style.height = 'auto';
            textInput.style.height = (textInput.scrollHeight) + 'px';
        });
    </script>
</body>
</html>
